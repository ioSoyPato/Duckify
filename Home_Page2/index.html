<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Main Home</title>
    <link rel="stylesheet" href="/static4/style.css">
    <script src="https://code.iconify.design/2/2.2.1/iconify.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body id="body">
    <!-- <audio controls id="song" autoplay loop style="margin-left: 40%; margin-top: 20px; display: none;">
        <source src="/static/tracks/{{genre}}/{{artist}}/{{title}}" type="audio/mpeg">
        Tu navegador no soporta audio HTML5.
    </audio>     -->
    <nav class="sidebar">
        <div class="sidebar--brand">
            <img src="/static4/logo2.png" alt="Logo">
        </div>
        <div class="menu menu-extra">
            <div class="menu--item active">
                <a href="http://127.0.0.1:4444/home/music/">
                    <span class="iconify" data-icon="mdi:home-outline"></span>
                    <span>Home</span>
                </a>
            </div>
            <div class="menu--item">
                <a href="#">
                    <span class="iconify" data-icon="mdi:magnify"></span>
                    <span>Search</span>
                </a>
            </div>
            <div class="menu--item">
                <a href="#">
                    <span class="iconify" data-icon="mdi:library-music"></span>
                    <span>Your Library</span>
                </a>
            </div>
            <div class="menu--item">
                <a href="#">
                    <span>üçâ Liked Songs</span>
                </a>
            </div>
            <div class="menu--item">
                <a href="https://github.com/ioSoyPato/Duckify" target="_blank">
                    <span class="iconify" data-icon="mdi:playlist-music"></span>
                    <span>Git-Hub</span>
                </a>
            </div>
            <div class="menu--item">
                <a href="#">
                    <span class="iconify" data-icon="mdi:podcast"></span>
                    <span>Settings</span>
                </a>
            </div>
            <div class="menu--item">
                <a href="http://127.0.0.1:4444">
                    <span class="iconify" data-icon="mdi:radio"></span>
                    <span>log-out</span>
                </a>
            </div>
        </div>
        <div class="container" style="margin-top: 50px;">
            <div class="music-player">
            <div class="controls">
                <a href="http://127.0.0.1:4444/playlist/{{genre}}/{{artist}}/{{title}}" class="no-underline">
                    <button class="next-song">
                        ü•ù
                    </button>
                </a>
                <a href="http://127.0.0.1:4444/playlist/{{genre}}/{{artist}}/{{title}}" class="no-underline" style="margin-left: 90px;">
                    <button class="next-song">
                        üç©
                    </button>
                </a>
            </div>
            <!-- <a href="http://127.0.0.1:4444/playlist/{{genre}}/{{artist}}/{{title}}" style="font-size: 25px;">ü•ù</a> -->
            <h1 class="title1" style="font-size:large;">{{title_show}}</h1>
            <p class="artist1">{{artist_show}}</p>

            <audio controls id="song", style="display: none;">
                <source src="/static/tracks/{{genre}}/{{artist}}/{{title}}" type="audio/mpeg">
            </audio>
            <input type="range" value="0" id="progress">

            <div class="controls">
                <button class="back-button"><i class="fa-solid fa-backward"></i></button>
                <button class="play-pause" onclick="playPause()"><i class="fa-solid fa-pause" id="ctrlIcon"></i></button>
                <a href="{{url_for('get_next_song_home', genre=genre, artist=artist, title=title)}}" class="no-underline">
                  <button class="next-song">
                    <i class="fa-solid fa-forward arrow-green"></i>
                  </button>
                </a>
                <a href="#" class="no-underline">
                    <button class="like-button">üçâ</button>
                </a>        
                <!-- <button class="like-button">üçâ</button> -->
                <!-- <button class="next-song"><a href="{{url_for('get_next_song', genre=genre, artist = artist, title=title)}}"><i class="fa-solid fa-forward"></i></a></button> -->
            </div>
            </div>
        </div>


    </nav>
    <main class="main-content">
        <h1 style="margin-bottom: 50px;">Our selection for you</h1>
        <div class="playlists">
            <div class="playlists-container">
                <div class="playlist">
                    <a href="http://127.0.0.1:4444/home/music/RAP/Childish_Gambino/Les.mp3">
                        <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 1">
                        <div class="playlist--info">
                            <h3>Les</h3>
                        </div>
                    </a>
                </div>
                <!-- Nueva Cancion aqu√≠ -->
                <div class="playlist">
                    <a href="http://127.0.0.1:4444/home/music/POP/Hozier/Hozier - Take Me To Church.mp3">
                        <img src="/static4/playlist-cover-g.png" alt="Playlist Cover 2">
                        <div class="playlist--info">
                            <h3>Take Me To Church</h3>
                        </div>
                    </a>
                </div>
                <!-- Nueva Cancion aqu√≠ --> 
                <div class="playlist">
                    <a href="http://127.0.0.1:4444/home/music/RAP/Metro_Boomin/Metro Boomin, The Weeknd, 21 Savage - Creepin' (Visualizer).mp3">
                        <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                        <div class="playlist--info">
                            <h3>Creepin'</h3>
                        </div>
                    </a>
                </div>
                <!-- Nueva Cancion aqu√≠ -->
                <div class="playlist">
                    <a href="http://127.0.0.1:4444/home/music/POP/Ariana_Grande/Side To Side.mp3">
                        <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                        <div class="playlist--info">
                            <h3>Side To Side</h3>
                        </div>
                    </a>
                </div>
            </div>
            </div>
            </div>
            <div class="playlists">
                <div class="playlists-container">
                    <div class="playlist">
                        <a href="http://127.0.0.1:4444/home/music/ROCK/Imagine_Dragons/Imagine Dragons - Believer (Official Music Video).mp3">
                            <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 1">
                            <div class="playlist--info">
                                <h3>Believer</h3>
                            </div>
                        </a>
                    </div>
                    <!-- Nueva Cancion aqu√≠ -->
                    <div class="playlist">
                        <a href="http://127.0.0.1:4444/home/music/RAP/Frank_Ocean/Frank Ocean - Nights.mp3">
                            <img src="/static4/playlist-cover-g.png" alt="Playlist Cover 2">
                            <div class="playlist--info">
                                <h3>Nights</h3>
                            </div>
                        </a>
                    </div>
                    <!-- Nueva Cancion aqu√≠ -->
                    <div class="playlist">
                        <a href="http://127.0.0.1:4444/home/music/ELECTRONIC/David_Guetta/David Guetta Feat. Akon - Sexy Chick (Official Video).mp3">
                            <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                            <div class="playlist--info">
                                <h3>Sexy Chick</h3>
                            </div>
                        </a>
                    </div>
                    <!-- Nueva Cancion aqu√≠ -->
                    <div class="playlist">
                        <a href="http://127.0.0.1:4444/home/music/POP/Pitbull/DJ Felli Fel - Boomerang Feat. Akon, Pitbull & Jermaine Dupri [Official Video] HD.mp3">
                            <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                            <div class="playlist--info">
                                <h3>Boomerang</h3>
                            </div>
                        </a>
                    </div>
                </div>
                </div>
                </div>
                <div class="playlists">
                    <div class="playlists-container">
                        <div class="playlist">
                            <a href="http://127.0.0.1:4444/home/music/RAP/Kendrick_Lamar/Kendrick Lamar - Money Trees (Feat. Jay Rock).mp3">
                                <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 1">
                                <div class="playlist--info">
                                    <h3>Money Trees</h3>
                                </div>
                            </a>
                        </div>
                        <!-- Nueva Cancion aqu√≠ -->
                        <div class="playlist">
                            <a href="http://127.0.0.1:4444/home/music/ROCK/Arctic_Monkeys/I Wanna Be Yours.mp3">
                                <img src="/static4/playlist-cover-g.png" alt="Playlist Cover 2">
                                <div class="playlist--info">
                                    <h3>I Wanna Be Yours</h3>
                                </div>
                            </a>
                        </div>
                        <!-- Nueva Cancion aqu√≠ -->
                        <div class="playlist">
                            <a href="http://127.0.0.1:4444/home/music/ELECTRONIC/Julian_Casablancas/Daft Punk - Instant Crush (Video) ft. Julian Casablancas.mp3">
                                <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                                <div class="playlist--info">
                                    <h3>Instant Crush</h3>
                                </div>
                            </a>
                        </div>
                        <!-- Nueva Cancion aqu√≠ -->
                        <div class="playlist">
                            <a href="http://127.0.0.1:4444/home/music/POP/Billie_Eilish/Billie Eilish - bad guy (Official Music Video).mp3">
                                <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                                <div class="playlist--info">
                                    <h3>Bad Guy</h3>
                                </div>
                            </a>
                        </div>
                    </div>
                    </div>
                    </div>
                    <div class="playlists">
                        <div class="playlists-container">
                            <div class="playlist">
                                <a href="http://127.0.0.1:4444/home/music/ROCK/Gorillaz/Feel Good Inc..mp3">
                                    <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 1">
                                    <div class="playlist--info">
                                        <h3>Feel Good Inc</h3>
                                    </div>
                                </a>
                            </div>
                            <!-- Nueva Cancion aqu√≠ -->
                            <div class="playlist">
                                <a href="http://127.0.0.1:4444/home/music/RAP/Future/Future - Life Is Good (Official Music Video) ft. Drake.mp3">
                                    <img src="/static4/playlist-cover-g.png" alt="Playlist Cover 2">
                                    <div class="playlist--info">
                                        <h3>Life is Good</h3>
                                    </div>
                                </a>
                            </div>
                            <!-- Nueva Cancion aqu√≠ -->
                            <div class="playlist">
                                <a href="http://127.0.0.1:4444/home/music/ELECTRONIC/Fred_Again/Fred again.. feat. The Blessed Madonna - Marea (We‚Äôve Lost Dancing) (Official Audio).mp3">
                                    <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                                    <div class="playlist--info">
                                        <h3>Marea</h3>
                                    </div>
                                </a>
                            </div>
                            <!-- Nueva Cancion aqu√≠ -->
                            <div class="playlist">
                                <a href="http://127.0.0.1:4444/home/music/POP/Kygo/Kygo - Stole The Show (Lyrics) feat. Parson James.mp3">
                                    <img src="/static4/playlist-cover-1.png" alt="Playlist Cover 2">
                                    <div class="playlist--info">
                                        <h3>Stole the Show</h3>
                                    </div>
                                </a>
                            </div>
                        </div>
                        </div>
                        </div>
            <h1>Ducki Playlist</h1>
            <p>Create a Playlist using Ducki AI</p>
            <div class="playlist">
                <a href="http://127.0.0.1:7860">
                    <img src="/static4/playlist-cover-2.png" alt="Playlist Cover 2">
                    <div class="playlist--info">
                        <h3>Soon</h3>
                    </div>
                </a>
            </div>
    </main>

    <script>
        // Add an event listener to the input to check for the Enter key
        document.getElementById('body').addEventListener('keypress', function(event) {
            if (event.key === 'Enter') {
                event.preventDefault(); // Prevent the default action to stop the form from submitting
                playPause();
            }
        });
        document.getElementById('body').addEventListener('keypress', function(event) {
            if (event.key === 'l') {
                event.preventDefault(); // Prevent the default action to stop the form from submitting
                playPause();  //Change to like
            }
        });

        window.onload = function() {
        var song = document.getElementById('song');
        var savedTime = localStorage.getItem('currentTime');
        if (savedTime) {
            song.currentTime = parseFloat(savedTime);
            song.play();
        }
        else {console.log('No saved time');}
    }

    let progress = document.getElementById('progress');
    let song = document.getElementById('song');
    let ctrlIcon = document.getElementById('ctrlIcon');

    song.onloadeddata = function(){
        progress.max = song.duration;
        progress.value = song.currentTime;
    }

    function playPause(){
        if(ctrlIcon.classList.contains('fa-pause')){
            song.pause();
            ctrlIcon.classList.remove('fa-pause');
            ctrlIcon.classList.add('fa-play');
        }
        else{
            song.play();
            ctrlIcon.classList.add('fa-pause');
            ctrlIcon.classList.remove('fa-play');
        }
    }

    if (song.play()){
      setInterval(() => {
          progress.value = song.currentTime;
      }, 500);
    }

    document.querySelector('.back-button').addEventListener('click', function() {
      window.history.back();
  })

    window.onbeforeunload = function() {
        localStorage.setItem('currentTime', song.currentTime);
    }

    window.onload = function() {
          var song = document.getElementById('song');
          var savedTime = localStorage.getItem('currentTime');
          if (savedTime) {
              song.currentTime = parseFloat(savedTime);
              song.play();
          }
          else {console.log('No saved time');}
      }

    song.onloadeddata = function(){
        progress.max = song.duration;
        progress.value = song.currentTime;
    }

    function playPause(){
        if(ctrlIcon.classList.contains('fa-pause')){
            song.pause();
            ctrlIcon.classList.remove('fa-pause');
            ctrlIcon.classList.add('fa-play');
        }
        else{
            song.play();
            ctrlIcon.classList.add('fa-pause');
            ctrlIcon.classList.remove('fa-play');
        }
    }

    if (song.play()){
        setInterval(() => {
            progress.value = song.currentTime;
        }, 500);
    }

    progress.onchange = function(){
        song.play();
        song.currentTime = progress.value;
        ctrlIcon.classList.add('fa-pause');
        ctrlIcon.classList.remove('fa-play');
    }

    document.querySelector('.back-button').addEventListener('click', function() {
        window.history.back();
    })

    window.onbeforeunload = function() {
            localStorage.setItem('currentTime', song.currentTime);
        }

    function likeSong(genre, artist, title) {
        const url = `/home/music/like/${genre}/${artist}/${title}`;
        fetch(url, {method: 'POST'})
        .then(response => response.json())
        .then(data => console.log(data));
    }

    </script>
</body>